---
import Layout from '../layouts/Layout.astro';
import CodeRunner from '../components/CodeRunner.astro';

const helloCode = `(println "Hello from Gene!")`;

const featuresCode = `# Variables and string interpolation
(var name "Gene")
(println "Hello, #{name}!")

# Functions with closures
(fn make_adder [x]
  (fn [y] (x + y)))
(var add5 (make_adder 5))
(println (add5 10))         # => 15

# Collection methods
(var nums [1 2 3 4 5])
(println (nums .map (fn [x] (x * 2))))   # => [2 4 6 8 10]
(println (nums .filter (fn [x] (x > 3)))) # => [4 5]`;

const classCode = `(class Point
  (ctor [x y]
    (/x = x)
    (/y = y))
  (method to_s []
    ("Point(" .append (str /x) ", " (str /y) ")")))

(var p (new Point 3 4))
(println p/.to_s)           # => Point(3, 4)
(println (p is Point))      # => true`;
---

<Layout
	title="Getting Started with Gene"
	description="Install the Gene toolchain, build the VM, and run your first program in minutes."
>
	<section class="hero">
		<h1>Getting started</h1>
		<p class="intro">
			Follow the steps below to install the Gene runtime, compile from source, and run your first
			program. Gene builds on Nim, so the same instructions work across macOS and Linux.
		</p>
		<div class="quick-actions">
			<a class="button primary" href="https://github.com/gcao/genex" rel="noopener">View source on GitHub</a>
			<a class="button secondary" href="/docs">Explore documentation</a>
		</div>
	</section>

	<section class="step">
		<h2>1. Install prerequisites</h2>
		<ul>
			<li>
				Install <a href="https://nim-lang.org/install.html" rel="noopener">Nim 2.0 or newer</a> — use
				<code>choosenim</code> for easy version management.
			</li>
			<li>Ensure a C compiler is available (<code>clang</code> or <code>gcc</code>).</li>
			<li>Optional but recommended: install <code>git</code> to fetch updates.</li>
		</ul>
	</section>

	<section class="step">
		<h2>2. Clone the repository</h2>
		<pre aria-label="Clone the Gene repository">
<code class="language-bash">git clone https://github.com/gcao/genex.git
cd genex</code>
		</pre>
		<p>If you are contributing, fork the repository first and add your fork as the <code>origin</code> remote.</p>
	</section>

	<section class="step">
		<h2>3. Build the Gene runtime</h2>
		<p>
			Gene ships as a Nim project. Use <code>nimble</code> to build the bytecode VM and CLI tooling.
		</p>
		<pre aria-label="Build the Gene executable">
<code class="language-bash"># Debug build (faster to compile)
nimble build

# Release build (faster to run)
nimble build -d:release</code>
		</pre>
		<p>
			The compiled binary lands in <code>bin/gene</code>. You can also build the WASM module for
			browser use:
		</p>
		<pre aria-label="Build the WASM module">
<code class="language-bash">nimble wasm   # produces web/gene_wasm.js + web/gene_wasm.wasm</code>
		</pre>
	</section>

	<section class="step">
		<h2>4. Verify your installation</h2>
		<p>Run the CLI to confirm everything is wired up:</p>
		<pre aria-label="Verify the Gene CLI">
<code class="language-bash">./bin/gene help
./bin/gene eval '(println "Hello, Gene!")'</code>
		</pre>
		<p>Gene provides these main commands:</p>
		<ul>
			<li><code>run &lt;file&gt;</code> — compile and execute a <code>.gene</code> program</li>
			<li><code>eval &lt;code&gt;</code> — evaluate an inline Gene expression</li>
			<li><code>repl</code> — interactive REPL with breakpoint support</li>
			<li><code>pipe</code> — read Gene code from stdin for Unix pipeline processing</li>
		</ul>
	</section>

	<section class="step">
		<h2>5. Run your first program</h2>
		<p>Create a file named <code>hello.gene</code>:</p>
		<CodeRunner code={helloCode} />
		<p>Execute it from the command line:</p>
		<pre aria-label="Run a Gene program">
<code class="language-bash">./bin/gene run hello.gene</code>
		</pre>
		<p>
			Or click <strong>▶ Run</strong> above to evaluate it live in your browser via WASM.
		</p>
	</section>

	<section class="step">
		<h2>6. Explore core features</h2>
		<p>
			Gene's homoiconic design means code and data share the same structure. Try these examples —
			each has a <strong>▶ Run</strong> button to evaluate in the browser.
		</p>

		<h3>Variables, closures &amp; collections</h3>
		<CodeRunner code={featuresCode} />

		<h3>Classes &amp; OOP</h3>
		<CodeRunner code={classCode} />
	</section>

	<section class="step">
		<h2>Where to go next</h2>
		<ul class="next-steps">
			<li>
				Browse the <a href="/examples">examples gallery</a> — click ▶ Run on any example to evaluate
				it live in the browser.
			</li>
			<li>
				Read the <a href="/docs">documentation</a> for generators, AOP, capability sandboxing, and
				checkpoint/resume.
			</li>
			<li>
				Explore <code>examples/full.gene</code> in the repository — a 700-line runnable reference
				covering every language feature.
			</li>
			<li>
				Run <code>./bin/gene repl</code> for an interactive shell with breakpoint support and
				<code>--repl-on-error</code> mode.
			</li>
		</ul>
	</section>
</Layout>

<style>
	.hero {
		display: grid;
		gap: 1.5rem;
		margin-bottom: 2rem;
	}

	.hero h1 {
		font-size: clamp(2rem, 3vw, 2.6rem);
		margin: 0;
	}

	.intro {
		margin: 0;
		max-width: 44rem;
		color: var(--color-muted);
		font-size: 1.05rem;
	}

	.quick-actions {
		display: flex;
		gap: 1rem;
		flex-wrap: wrap;
	}

	.button {
		border-radius: 999px;
		padding: 0.65rem 1.6rem;
		font-weight: 600;
		display: inline-flex;
		align-items: center;
		border: 1px solid transparent;
	}

	.button.primary {
		background: var(--color-accent);
		color: white;
		box-shadow: 0 12px 24px rgba(37, 99, 235, 0.2);
	}

	.button.secondary {
		border: 1px solid var(--color-border);
		color: var(--color-text);
	}

	.step {
		margin-top: 3rem;
	}

	.step h2 {
		margin-bottom: 0.75rem;
		font-size: 1.6rem;
	}

	.step h3 {
		margin-top: 1.75rem;
		margin-bottom: 0.25rem;
		font-size: 1.15rem;
		color: var(--color-accent);
	}

	.step p {
		color: var(--color-muted);
		max-width: 46rem;
	}

	.step ul {
		list-style: disc;
		padding-left: 1.2rem;
		color: var(--color-muted);
		display: grid;
		gap: 0.5rem;
		max-width: 46rem;
	}

	.next-steps {
		list-style: disc;
		padding-left: 1.2rem;
		color: var(--color-muted);
		display: grid;
		gap: 0.4rem;
		max-width: 44rem;
	}

	pre {
		margin-top: 0.75rem;
		margin-bottom: 0.75rem;
	}
</style>
